<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>systole.recording.Oximeter &#8212; systole 0.1.1 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-dataframe.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><span><img src="../_static/logo.png"></span>
          systole</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../api.html">Functions</a></li>
                <li><a href="../auto_examples/index.html">Tutorials</a></li>
                <li><a href="https://github.com/embodied-computation-group/systole">GitHub</a></li>
                <li><a href="../changelog.html">What's new</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">systole.recording.Oximeter</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/generated/systole.recording.Oximeter.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="section" id="systole-recording-oximeter">
<h1>systole.recording.Oximeter<a class="headerlink" href="#systole-recording-oximeter" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="systole.recording.Oximeter">
<em class="property">class </em><code class="sig-prename descclassname">systole.recording.</code><code class="sig-name descname">Oximeter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">serial</span></em>, <em class="sig-param"><span class="n">sfreq</span><span class="o">=</span><span class="default_value">75</span></em>, <em class="sig-param"><span class="n">add_channels</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/systole/recording.html#Oximeter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#systole.recording.Oximeter" title="Permalink to this definition">¶</a></dt>
<dd><p>Recording PPG signal with Nonin pulse oximeter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>serial</strong><span class="classifier">pySerial object</span></dt><dd><p>The <cite>serial</cite> instance interfacing with the USB port.</p>
</dd>
<dt><strong>sfreq</strong><span class="classifier">int</span></dt><dd><p>The sampling frequency of the recording. Defautl is 75 Hz.</p>
</dd>
<dt><strong>add_channels</strong><span class="classifier">int</span></dt><dd><p>If int, will create as many additionnal channels. If None, no
additional channels created.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>First, you will need to define a <code class="xref py py-func docutils literal notranslate"><span class="pre">serial()</span></code> instance, indexing the
USB port where the Nonin Pulse Oximeter is plugged.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">serial</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span> <span class="o">=</span> <span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">(</span><span class="s1">&#39;COM4&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This instance is then used to create an <a class="reference internal" href="#systole.recording.Oximeter" title="systole.recording.Oximeter"><code class="xref py py-func docutils literal notranslate"><span class="pre">Oximeter()</span></code></a> instance that
will be used for the recording.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ecgrecording</span> <span class="kn">import</span> <span class="n">Oximeter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">oximeter</span> <span class="o">=</span> <span class="n">Oximeter</span><span class="p">(</span><span class="n">serial</span><span class="o">=</span><span class="n">ser</span><span class="p">,</span> <span class="n">sfreq</span><span class="o">=</span><span class="mi">75</span><span class="p">)</span>
</pre></div>
</div>
<p>Use the <code class="xref py py-func docutils literal notranslate"><span class="pre">setup()</span></code> method to initialize the recording. This will find
the start byte to ensure that all the forthcoming data is in Synch. You
should not wait more than ~10s between the setup and the recording,
otherwise the buffer will start to overwrite the data.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">oximeter</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>
</pre></div>
</div>
<p>Two methods are availlable to record PPG signal:</p>
<ol class="arabic simple">
<li><p>The <code class="xref py py-func docutils literal notranslate"><span class="pre">read()</span></code> function.</p></li>
</ol>
<p>Will continuously record for certain amount of time (specified by the
<em>duration</em> parameter, in seconds). This is the easiest and most robust
method, but it is not possible to run instructions in the meantime.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">oximeter</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>The <code class="xref py py-func docutils literal notranslate"><span class="pre">readInWaiting()</span></code> function.</p></li>
</ol>
<p>Will read all the availlable bytes (up to 10 seconds of recording). When
inserted into a while loop, it allows to record PPG signal together with
other scripts.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tstart</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">while</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">tstart</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">oximeter</span><span class="o">.</span><span class="n">readInWaiting</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># Insert code here</span>
</pre></div>
</div>
<p>The recorded signal can latter be inspected using the <code class="xref py py-func docutils literal notranslate"><span class="pre">plot()</span></code>
method.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">oximeter</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Data read from the serial port are appended to list and
processed for pulse detection and instantaneous heart rate estimation.
The time required to append new data to the recording will increase as
its size increase. You should beware that this processing time does not
exceed the sampling frequency (i.e. 75Hz or 0.013 seconds per sample for
Nonin pulse oximeters) to allow continuous recording and fast processing
of in waiting samples. We recommend storing regularly 5 minutes recording
as .npy file using the :py:func:save() function.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>instant_rr</strong><span class="classifier">list</span></dt><dd><p>Time serie of instantaneous heartrate.</p>
</dd>
<dt><strong>n_channels</strong><span class="classifier">int | None</span></dt><dd><p>Number of additional channels.</p>
</dd>
<dt><strong>recording</strong><span class="classifier">list</span></dt><dd><p>Time serie of PPG signal.</p>
</dd>
<dt><strong>sfreq</strong><span class="classifier">int</span></dt><dd><p>Sampling frequnecy. Default value is 75 Hz.</p>
</dd>
<dt><strong>threshold</strong><span class="classifier">list</span></dt><dd><p>The threshold used to detect beat peaks. Will use the average +
standars deviation.</p>
</dd>
<dt><strong>times</strong><span class="classifier">list</span></dt><dd><p>Time vector (in seconds).</p>
</dd>
<dt><strong>diff</strong><span class="classifier">list</span></dt><dd><p>Records the differential of the PPG signal. Used to detect heartbeat
peaks.</p>
</dd>
<dt><strong>peaks</strong><span class="classifier">list</span></dt><dd><p>List of 0 and 1. 1 index detected peaks.</p>
</dd>
<dt><strong>channels</strong><span class="classifier">list | dict</span></dt><dd><p>Additional channels to record. Will continuously record <em>n_channels</em>
additional channels in parallel of <cite>recording</cite> with default <cite>0</cite> as
defalut value.</p>
</dd>
<dt><strong>serial</strong><span class="classifier">PySerial instance</span></dt><dd><p>PySerial object indexing the USB port to read.</p>
</dd>
<dt><strong>rr</strong><span class="classifier">list or None</span></dt><dd><p>RR intervals time course. The time course will be generated if
<code class="xref py py-func docutils literal notranslate"><span class="pre">self.find_peaks()</span></code> is used.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="systole.recording.Oximeter.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">serial</span></em>, <em class="sig-param"><span class="n">sfreq</span><span class="o">=</span><span class="default_value">75</span></em>, <em class="sig-param"><span class="n">add_channels</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/systole/recording.html#Oximeter.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#systole.recording.Oximeter.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#systole.recording.Oximeter.__init__" title="systole.recording.Oximeter.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(self, serial[, sfreq, add_channels])</p></td>
<td><p>Initialize self.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_paquet</span></code>(self, paquet[, window])</p></td>
<td><p>Read a portion of data.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">check</span></code>(self, paquet)</p></td>
<td><p>Check if the provided paquet is correct</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_peaks</span></code>(self, \*\*kwargs)</p></td>
<td><p>Find peaks in recorded signal.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_events</span></code>(self[, ax])</p></td>
<td><p>Visualize the distribution of events stored in additional channels.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_hr</span></code>(self[, ax])</p></td>
<td><p>Plot heartrate extracted from PPG recording.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_recording</span></code>(self[, ax])</p></td>
<td><p>Plot recorded signal.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">read</span></code>(self, duration)</p></td>
<td><p>Find start byte.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">readInWaiting</span></code>(self[, stop])</p></td>
<td><p>Read in wainting oxi data.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(self, fname)</p></td>
<td><p>Save the recording instance.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">setup</span></code>(self[, read_duration, clear_peaks])</p></td>
<td><p>Find start byte and read a portion of signal.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">waitBeat</span></code>(self)</p></td>
<td><p>Read Oximeter until a heartbeat is detected.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2020, Nicolas Legrand.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>
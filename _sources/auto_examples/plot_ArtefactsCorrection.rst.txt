
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples\plot_ArtefactsCorrection.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_plot_ArtefactsCorrection.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_plot_ArtefactsCorrection.py:


Outliers and ectobeats correction
=================================

Here, we describe two method for artefacts and outliers correction, after
detection using the method proposed by Lipponen & Tarvainen (2019) [#]_.

.. GENERATED FROM PYTHON SOURCE LINES 8-24

.. code-block:: default


    # Author: Nicolas Legrand <nicolas.legrand@cfin.au.dk>
    # Licence: GPL v3

    # Two approaches for artefacts correction are proposed:
    # * `correct_peaks()` will find and correct artefacts in a boolean peaks
    # vector, thus ensuring the length of recording remain constant and corrected
    # peaks fit the signal sampling rate. This method is more adapted to
    # event-related cardiac activity designs.

    # * `correct_rr()` will find and correct artefacts in the RR time series. The
    # signal length will possibly change after the interpolation of long, short or
    # ectopic beats. This method is more relevant for HRV analyse of long recording
    # where the timing of experimental events is not important.

    import matplotlib.pyplot as plt







.. GENERATED FROM PYTHON SOURCE LINES 25-31

.. code-block:: default

    import numpy as np

    from systole import simulate_rr
    from systole.correction import correct_peaks, correct_rr
    from systole.plotting import plot_subspaces








.. GENERATED FROM PYTHON SOURCE LINES 32-33

#############################

.. GENERATED FROM PYTHON SOURCE LINES 33-38

.. code-block:: default


    peaks = simulate_rr(as_peaks=True)
    peaks_correction = correct_peaks(peaks)
    peaks_correction





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    {'clean_peaks': array([ True, False, False, ..., False, False, False]), 'ectopic': 0, 'short': 0, 'long': 0, 'extra': 1, 'missed': 1}



.. GENERATED FROM PYTHON SOURCE LINES 39-40

#############################

.. GENERATED FROM PYTHON SOURCE LINES 40-43

.. code-block:: default

    rr = simulate_rr()
    rr_correction = correct_rr(rr)








.. GENERATED FROM PYTHON SOURCE LINES 44-50

References
----------
.. [#] Lipponen, J. A., & Tarvainen, M. P. (2019). A robust algorithm for
  heart rate variability time series artefact correction using novel
  beat classification. Journal of Medical Engineering & Technology,
  43(3), 173â€“181. https://doi.org/10.1080/03091902.2019.1640306


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.132 seconds)


.. _sphx_glr_download_auto_examples_plot_ArtefactsCorrection.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_ArtefactsCorrection.py <plot_ArtefactsCorrection.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_ArtefactsCorrection.ipynb <plot_ArtefactsCorrection.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
